{{ define "main" }}

<article class="entry">
    <header class="entry-header">
        <h2 class="entry-title">{{ .Title }}</h2>
    </header>

    <div class="entry-content">

        <div id="map-wrap"></div>

        <script type="text/javascript">

            var options1 = {
                color: "#f00",
                width: 3,
                outlineWidth: 0
            };

            var map = mczCreateMap('map-wrap');

            var layer = new SMap.Layer.Geometry();
            map.addLayer(layer);
            layer.enable();

            // list of points from all gpx tracks
            var points_all = [];

            {{- range .Site.Data.heat_map.tracks.tracks -}}

                // list of points from one track
                var points_line = [];

                {{- range .points -}}

                    var mp = SMap.Coords.fromWGS84({{- .lng -}}, {{- .lat -}});

                    points_all.push(mp);
                    points_line.push(mp);

                {{- end -}}

                var polyline = new SMap.Geometry(SMap.GEOMETRY_POLYLINE, null, points_line, options1);
                layer.addGeometry(polyline);

                    // compute and set new center and zoom, the goal is to see all tracks
                var new_center_all = map.computeCenterZoom(points_all, true);
                map.setCenterZoom(new_center_all[0], new_center_all[1]);

            {{- end -}}

        </script>
    </div>
</article>

{{ end }}
